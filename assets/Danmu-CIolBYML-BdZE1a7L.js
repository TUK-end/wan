import{u as a,t as e,n as l}from"./danmu-Bwh-s-Om-BgVir-Fi.js";import{l as t,_ as s,a as u,H as n,N as o,q as r,U as c,p as d,d as i,b as p,e as v,c as m,J as E,a5 as g,u as b}from"./index-CXpj-iG1.js";const y={class:"danmu-page"},D={class:"toolbar"},P=t({__name:"Danmu",setup(t){const P=s([]),f=s(""),C=s(1),_=s(20),w=s(0),N=async()=>{var a,l;try{const t=await e({page:C.value,size:_.value,status:f.value||void 0});P.value=(null==(a=t.data)?void 0:a.list)||[],w.value=(null==(l=t.data)?void 0:l.total)||0}catch(t){b.error("加载弹幕列表失败: "+(t.message||"未知错误"))}},h=async(a,e)=>{try{await l(a,e),b.success("审核成功"),N()}catch(t){}},k=a=>({PENDING:"待审核",APPROVED:"已发布",REJECTED:"已屏蔽"}[a]||a);return u(()=>{N()}),(e,l)=>{const t=i("el-option"),s=i("el-select"),u=i("el-table-column"),R=i("el-tag"),I=i("el-button"),V=i("el-table"),z=i("el-pagination");return o(),n("div",y,[l[5]||(l[5]=r("h1",null,"弹幕管理",-1)),r("div",D,[c(s,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=a=>f.value=a),placeholder:"状态筛选",onChange:N,clearable:""},{default:d(()=>[c(t,{label:"待审核",value:"PENDING"}),c(t,{label:"已发布",value:"APPROVED"}),c(t,{label:"已屏蔽",value:"REJECTED"})]),_:1},8,["modelValue"])]),c(V,{data:P.value,style:{width:"100%"}},{default:d(()=>[c(u,{prop:"id",label:"ID",width:"80"}),c(u,{prop:"username",label:"用户"}),c(u,{prop:"content",label:"内容"}),c(u,{prop:"celebrityName",label:"关联名人"}),c(u,{prop:"status",label:"状态"},{default:d(({row:a})=>{return[c(R,{type:(e=a.status,{PENDING:"warning",APPROVED:"success",REJECTED:"danger"}[e]||"info")},{default:d(()=>[p(v(k(a.status)),1)]),_:2},1032,["type"])];var e}),_:1}),c(u,{prop:"createTime",label:"发送时间"}),c(u,{label:"操作",width:"200"},{default:d(({row:e})=>["PENDING"===e.status?(o(),m(I,{key:0,size:"small",type:"success",onClick:a=>h(e.id,"APPROVED")},{default:d(()=>[...l[2]||(l[2]=[p(" 通过 ",-1)])]),_:1},8,["onClick"])):E("",!0),"PENDING"===e.status?(o(),m(I,{key:1,size:"small",type:"danger",onClick:a=>h(e.id,"REJECTED")},{default:d(()=>[...l[3]||(l[3]=[p(" 拒绝 ",-1)])]),_:1},8,["onClick"])):E("",!0),c(I,{size:"small",type:"danger",onClick:l=>(async e=>{try{await g.confirm("确定删除该弹幕吗?","提示",{type:"warning"}),await a(e),b.success("删除成功"),N()}catch(l){}})(e.id)},{default:d(()=>[...l[4]||(l[4]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),c(z,{"current-page":C.value,"onUpdate:currentPage":l[1]||(l[1]=a=>C.value=a),"page-size":_.value,total:w.value,layout:"total, prev, pager, next",onCurrentChange:N},null,8,["current-page","page-size","total"])])}}},[["__scopeId","data-v-daec2086"]]);export{P as default};
