import{b as a,d as e,c as l}from"./danmu-CptEyIUe.js";import{_ as t,r as s,o as u,e as n,f as o,j as r,g as c,i,k as d,l as p,t as v,m,h as E,H as g,a5 as b}from"./index-CYfi38du.js";const y={class:"danmu-page"},D={class:"toolbar"},f=t({__name:"Danmu",setup(t){const f=s([]),P=s(""),C=s(1),_=s(20),h=s(0),w=async()=>{var e,l;try{const t=await a({page:C.value,size:_.value,status:P.value||void 0});f.value=(null==(e=t.data)?void 0:e.list)||[],h.value=(null==(l=t.data)?void 0:l.total)||0}catch(t){g.error("加载弹幕列表失败: "+(t.message||"未知错误"))}},N=async(a,e)=>{try{await l(a,e),g.success("审核成功"),w()}catch(t){}},k=a=>({PENDING:"待审核",APPROVED:"已发布",REJECTED:"已屏蔽"}[a]||a);return u(()=>{w()}),(a,l)=>{const t=d("el-option"),s=d("el-select"),u=d("el-table-column"),R=d("el-tag"),I=d("el-button"),V=d("el-table"),z=d("el-pagination");return o(),n("div",y,[l[5]||(l[5]=r("h1",null,"弹幕管理",-1)),r("div",D,[c(s,{modelValue:P.value,"onUpdate:modelValue":l[0]||(l[0]=a=>P.value=a),placeholder:"状态筛选",onChange:w,clearable:""},{default:i(()=>[c(t,{label:"待审核",value:"PENDING"}),c(t,{label:"已发布",value:"APPROVED"}),c(t,{label:"已屏蔽",value:"REJECTED"})]),_:1},8,["modelValue"])]),c(V,{data:f.value,style:{width:"100%"}},{default:i(()=>[c(u,{prop:"id",label:"ID",width:"80"}),c(u,{prop:"username",label:"用户"}),c(u,{prop:"content",label:"内容"}),c(u,{prop:"celebrityName",label:"关联名人"}),c(u,{prop:"status",label:"状态"},{default:i(({row:a})=>{return[c(R,{type:(e=a.status,{PENDING:"warning",APPROVED:"success",REJECTED:"danger"}[e]||"info")},{default:i(()=>[p(v(k(a.status)),1)]),_:2},1032,["type"])];var e}),_:1}),c(u,{prop:"createTime",label:"发送时间"}),c(u,{label:"操作",width:"200"},{default:i(({row:a})=>["PENDING"===a.status?(o(),m(I,{key:0,size:"small",type:"success",onClick:e=>N(a.id,"APPROVED")},{default:i(()=>[...l[2]||(l[2]=[p(" 通过 ",-1)])]),_:1},8,["onClick"])):E("",!0),"PENDING"===a.status?(o(),m(I,{key:1,size:"small",type:"danger",onClick:e=>N(a.id,"REJECTED")},{default:i(()=>[...l[3]||(l[3]=[p(" 拒绝 ",-1)])]),_:1},8,["onClick"])):E("",!0),c(I,{size:"small",type:"danger",onClick:l=>(async a=>{try{await b.confirm("确定删除该弹幕吗?","提示",{type:"warning"}),await e(a),g.success("删除成功"),w()}catch(l){}})(a.id)},{default:i(()=>[...l[4]||(l[4]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),c(z,{"current-page":C.value,"onUpdate:currentPage":l[1]||(l[1]=a=>C.value=a),"page-size":_.value,total:h.value,layout:"total, prev, pager, next",onCurrentChange:w},null,8,["current-page","page-size","total"])])}}},[["__scopeId","data-v-daec2086"]]);export{f as default};
