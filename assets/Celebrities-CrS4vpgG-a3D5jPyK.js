import{r as a,i as e,a as l,t}from"./celebrity-Dpk6slWv-CjbodMFZ.js";import{l as u,$ as o,_ as d,x as r,a as s,H as i,N as n,q as c,U as p,p as v,b as m,d as f,c as b,a5 as y,u as _,A as h,ac as w}from"./index-CXpj-iG1.js";const V={class:"celebrities-page"},g={class:"toolbar"},k={key:1,style:{color:"#999"}},x={class:"avatar-upload"},C=["src"],U=u({__name:"Celebrities",setup(u){const U=o(),z=d([]),j=d(!1),B=d({}),W=d(!1),A=r(()=>"/api/api/upload/image"),D=r(()=>({Authorization:`Bearer ${U.token}`})),I=async()=>{try{const a=await e({page:1,size:100});z.value=a.data.list}catch(a){}},M=a=>{B.value=a?{...a}:{},j.value=!0},$=a=>a?(a.startsWith("http"),a):"",q=a=>{const e=a.type.startsWith("image/"),l=a.size/1024/1024<10;return e?!!l||(_.error("图片大小不能超过 10MB!"),!1):(_.error("只能上传图片文件!"),!1)},H=a=>{200===a.code?(B.value.avatar=a.data,_.success("上传成功")):_.error(a.message||"上传失败")},N=a=>{_.error("上传失败，请重试")},T=async()=>{if(B.value.name){W.value=!0;try{B.value.id?await l(B.value.id,B.value):await t(B.value),_.success("保存成功"),j.value=!1,I()}catch(a){_.error("保存失败")}finally{W.value=!1}}else _.warning("请输入姓名")};return s(()=>{I()}),(e,l)=>{const t=f("el-button"),u=f("el-table-column"),o=f("el-image"),d=f("el-table"),r=f("el-icon"),s=f("el-upload"),U=f("el-form-item"),E=f("el-input"),F=f("el-switch"),G=f("el-form"),J=f("el-dialog");return n(),i("div",V,[l[15]||(l[15]=c("h1",null,"名人管理",-1)),c("div",g,[p(t,{type:"primary",onClick:l[0]||(l[0]=a=>M())},{default:v(()=>[...l[9]||(l[9]=[m("添加名人",-1)])]),_:1})]),p(d,{data:z.value,style:{width:"100%"}},{default:v(()=>[p(u,{prop:"id",label:"ID",width:"80"}),p(u,{label:"头像",width:"100"},{default:v(({row:a})=>[a.avatar?(n(),b(o,{key:0,src:$(a.avatar),style:{width:"60px",height:"60px","border-radius":"4px"},fit:"cover"},null,8,["src"])):(n(),i("span",k,"无"))]),_:1}),p(u,{prop:"name",label:"姓名"}),p(u,{prop:"field",label:"领域"}),p(u,{prop:"likes",label:"点赞数"}),p(u,{prop:"createTime",label:"创建时间"}),p(u,{label:"操作",width:"200"},{default:v(({row:e})=>[p(t,{size:"small",onClick:a=>M(e)},{default:v(()=>[...l[10]||(l[10]=[m("编辑",-1)])]),_:1},8,["onClick"]),p(t,{size:"small",type:"danger",onClick:l=>(async e=>{try{await y.confirm("确定删除该名人吗?","提示",{type:"warning"}),await a(e),_.success("删除成功"),I()}catch(l){}})(e.id)},{default:v(()=>[...l[11]||(l[11]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),p(J,{modelValue:j.value,"onUpdate:modelValue":l[8]||(l[8]=a=>j.value=a),title:B.value.id?"编辑名人":"添加名人",width:"600px"},{footer:v(()=>[p(t,{onClick:l[7]||(l[7]=a=>j.value=!1)},{default:v(()=>[...l[13]||(l[13]=[m("取消",-1)])]),_:1}),p(t,{type:"primary",onClick:T,loading:W.value},{default:v(()=>[...l[14]||(l[14]=[m("保存",-1)])]),_:1},8,["loading"])]),default:v(()=>[p(G,{model:B.value,"label-width":"100px"},{default:v(()=>[p(U,{label:"头像"},{default:v(()=>[c("div",x,[p(s,{class:"avatar-uploader",action:A.value,headers:D.value,"show-file-list":!1,"on-success":H,"on-error":N,"before-upload":q},{default:v(()=>[B.value.avatar?(n(),i("img",{key:0,src:$(B.value.avatar),class:"avatar"},null,8,C)):(n(),b(r,{key:1,class:"avatar-uploader-icon"},{default:v(()=>[p(h(w))]),_:1}))]),_:1},8,["action","headers"]),l[12]||(l[12]=c("div",{class:"upload-tip"},"支持jpg、png格式，大小不超过10MB",-1))])]),_:1}),p(U,{label:"姓名"},{default:v(()=>[p(E,{modelValue:B.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>B.value.name=a)},null,8,["modelValue"])]),_:1}),p(U,{label:"领域"},{default:v(()=>[p(E,{modelValue:B.value.field,"onUpdate:modelValue":l[2]||(l[2]=a=>B.value.field=a)},null,8,["modelValue"])]),_:1}),p(U,{label:"简介"},{default:v(()=>[p(E,{modelValue:B.value.description,"onUpdate:modelValue":l[3]||(l[3]=a=>B.value.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),p(U,{label:"详细介绍"},{default:v(()=>[p(E,{modelValue:B.value.biography,"onUpdate:modelValue":l[4]||(l[4]=a=>B.value.biography=a),type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),p(U,{label:"主要贡献"},{default:v(()=>[p(E,{modelValue:B.value.contributions,"onUpdate:modelValue":l[5]||(l[5]=a=>B.value.contributions=a),type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),p(U,{label:"是否推荐"},{default:v(()=>[p(F,{modelValue:B.value.featured,"onUpdate:modelValue":l[6]||(l[6]=a=>B.value.featured=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-cd1f506d"]]);export{U as default};
